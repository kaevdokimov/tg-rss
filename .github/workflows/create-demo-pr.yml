# Demo PR Creation Workflow
# Creates a sample PR to demonstrate code review process

name: "ðŸ“ Create Demo PR"

on:
  workflow_dispatch:
    # CKV_GHA_7: workflow_dispatch inputs removed for security
    # PR will be created with default values

permissions:
  contents: write
  pull-requests: write

jobs:
  create-demo-pr:
    name: 'Create Demo PR'
    runs-on: ubuntu-latest
    
    env:
      # Default values for PR creation
      PR_TITLE: 'docs: demonstrate code review process'
      PR_BODY: |
        This PR demonstrates the code review process for the repository.

        ## Changes
        - Minor documentation update to show PR workflow
        - Demonstrates branch protection and code review requirements

        ## Testing
        - Documentation changes only
        - No functional code changes
    
    steps:
      - name: Checkout code
        uses: actions/checkout@v6

      - name: Create demo change
        run: |
          # Create a small demo change
          echo "# Demo change for PR process" >> demo-change.txt
          echo "This file demonstrates the code review process." >> demo-change.txt

      - name: Create demo branch and PR
        run: |
          BRANCH_NAME="demo-pr-$(date +%s)"

          # Create and checkout new branch
          git checkout -b "$BRANCH_NAME"

          # Add the demo file
          git add demo-change.txt
          git commit -m "docs: Ð¿Ñ€Ð¾Ð´ÐµÐ¼Ð¾Ð½ÑÑ‚Ñ€Ð¸Ñ€Ð¾Ð²Ð°Ñ‚ÑŒ Ð¿Ñ€Ð¾Ñ†ÐµÑÑ code review

          - Ð´Ð¾Ð±Ð°Ð²Ð¸Ñ‚ÑŒ Ð´ÐµÐ¼Ð¾-Ñ„Ð°Ð¹Ð» Ð´Ð»Ñ Ð´ÐµÐ¼Ð¾Ð½ÑÑ‚Ñ€Ð°Ñ†Ð¸Ð¸ Ð¿Ñ€Ð¾Ñ†ÐµÑÑÐ° PR
          - Ð¿Ð¾ÐºÐ°Ð·Ð°Ñ‚ÑŒ Ñ€Ð°Ð±Ð¾Ñ‚Ñƒ Ð·Ð°Ñ‰Ð¸Ñ‚Ñ‹ Ð²ÐµÑ‚Ð¾Ðº Ð¸ Ð¾Ð±ÑÐ·Ð°Ñ‚ÐµÐ»ÑŒÐ½Ñ‹Ñ… reviews"

          # Push the branch
          git push origin "$BRANCH_NAME"

          # Create PR using GitHub CLI if available, otherwise just note it
          if command -v gh >/dev/null 2>&1; then
            gh pr create \
              --title "$PR_TITLE" \
              --body "$PR_BODY" \
              --base main \
              --head "$BRANCH_NAME"
          else
            echo "GitHub CLI not available. Please create PR manually from branch: $BRANCH_NAME"
            echo "PR Title: $PR_TITLE"
          fi