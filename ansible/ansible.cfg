[defaults]
host_key_checking = False
retry_files_enabled = False
gathering = smart
fact_caching = memory
stdout_callback = yaml
callback_whitelist = profile_tasks,timer
forks = 5
roles_path = ../roles

# Ansible Vault
# vault_password_file = .vault_password  # Для локального использования
# Для CI/CD vault пароль передается через переменную окружения
vault_identity_list = ~/.ansible/vault

# Inventory
inventory = inventory/%{ENVIRONMENT:-dev}/hosts.ini
inventory_plugins_enabled = host_list, script, auto, yaml, ini, toml

# Logging
log_path = ./logs/ansible.log
display_args_to_stdout = False
display_skipped_hosts = False

# Performance optimizations
forks = 10
internal_poll_interval = 0.002
fact_caching = jsonfile
fact_caching_connection = /tmp/ansible_facts_cache
fact_caching_timeout = 86400
gathering = smart
gather_timeout = 30
gather_subset = !hardware,!facter,!ohai
task_timeout = 300

# Security
deprecation_warnings = False
command_warnings = False
ansible_managed = "Ansible managed file - do not edit manually"

[ssh_connection]
ssh_args = -o ControlMaster=auto -o ControlPersist=300s -o StrictHostKeyChecking=no -o ServerAliveInterval=60 -o ServerAliveCountMax=10
pipelining = True
control_path_dir = /tmp/.ansible-cp
timeout = 300
retries = 3
reconnection_retries = 3

# Performance optimizations for SSH
compression = smart
scp_if_ssh = smart

[connection]
pipelining = True
ssh_args = -o ControlMaster=auto -o ControlPersist=300s -o StrictHostKeyChecking=no -o ServerAliveInterval=60 -o ServerAliveCountMax=10

# Async configuration
[async]
poll_interval = 0.5
job_timeout = 600
